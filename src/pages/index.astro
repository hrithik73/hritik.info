---
import { getCollection } from "astro:content";
import Container from "@components/Container.astro";
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ArrowCard.astro";
import Link from "@components/Link.astro";
import { dateRange } from "@lib/utils";
import { SITE, HOME, SOCIALS } from "@consts";
import { projects as localProjects } from "@consts";

const blog = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_POSTS_ON_HOMEPAGE);

const projects = (await getCollection("projects"))
  .filter((project) => !project.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, SITE.NUM_PROJECTS_ON_HOMEPAGE);

const allwork = (await getCollection("work"))
  .sort(
    (a, b) =>
      new Date(b.data.dateStart).valueOf() -
      new Date(a.data.dateStart).valueOf()
  )
  .slice(0, SITE.NUM_WORKS_ON_HOMEPAGE);

const work = await Promise.all(
  allwork.map(async (item) => {
    const { Content } = await item.render();
    return { ...item, Content };
  })
);
---

<PageLayout title={HOME.TITLE} description={HOME.DESCRIPTION}>
  <Container>
    <!-- Hero Section -->
    <section class="mb-32 md:mb-40">
      <div class="animate">
        <h1
          class="text-3xl md:text-4xl font-semibold text-black dark:text-white mb-6 leading-tight tracking-tight"
        >
          Hritik Singh
        </h1>
        <p
          class="text-lg md:text-xl text-black/60 dark:text-white/50 leading-relaxed max-w-xl"
        >
          Mobile app developer with 4+ years of experience building flagship
          React Native apps. Crafting pixel-perfect, smooth mobile experiences.
        </p>
      </div>
    </section>

    <div class="space-y-32 md:space-y-40">
      <!-- About -->
      <section class="animate">
        <p
          class="text-base md:text-lg text-black/70 dark:text-white/60 leading-relaxed space-y-5 max-w-2xl"
        >
          <span class="block">
            Currently building at <Link
              href="https://cars24.com"
              external
              class="font-medium text-black dark:text-white">CARS24</Link
            >, where I craft high-performance mobile apps with React Native.
          </span>
          <span class="block">
            Previously at <Link
              href="https://www.indianic.com/"
              external
              class="font-medium text-black dark:text-white">Indianic</Link
            >, I worked on diverse flagship apps including e-commerce, fitness, <Link
              href={localProjects[1].link}
              external
              class="font-medium text-black dark:text-white">CRM solutions</Link
            >, and <Link
              href={localProjects[0].link}
              external
              class="font-medium text-black dark:text-white"
              >social platforms</Link
            >.
          </span>
        </p>
      </section>

      <!-- Work Experience -->
      <section class="animate">
        <div class="flex items-center gap-3 mb-12">
          <h2
            class="text-xs font-medium text-black/40 dark:text-white/40 uppercase tracking-widest"
          >
            Experience
          </h2>
          <div
            class="flex-1 h-px bg-gradient-to-r from-black/10 to-transparent dark:from-white/10"
          >
          </div>
        </div>
        <ul class="flex flex-col space-y-12">
          {
            work.map((entry) => (
              <li class="relative pl-8 border-l border-black/5 dark:border-white/5 hover:border-black/10 dark:hover:border-white/10 transition-colors duration-300">
                <div class="absolute left-0 top-0 w-2 h-2 rounded-full bg-black/20 dark:bg-white/20 -translate-x-[5px]" />
                <div class="text-xs font-medium text-black/40 dark:text-white/40 uppercase tracking-wider mb-3">
                  {dateRange(entry.data.dateStart, entry.data.dateEnd)}
                </div>
                <div class="text-2xl font-semibold text-black dark:text-white mb-2 tracking-tight">
                  {entry.data.company}
                </div>
                <div class="text-sm text-black/50 dark:text-white/50 mb-5 font-medium">
                  {entry.data.role}
                </div>
                <div class="text-sm text-black/65 dark:text-white/60 leading-relaxed max-w-xl">
                  <entry.Content />
                </div>
              </li>
            ))
          }
        </ul>
        <div class="mt-10">
          <Link href="/work" class="text-sm font-medium group">
            <span class="inline-flex items-center gap-1">
              View all experience
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                class="w-3 h-3 stroke-2 fill-none stroke-current translate-x-0 group-hover:translate-x-1 transition-transform duration-200"
              >
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </span>
          </Link>
        </div>
      </section>

      <!-- Projects -->
      {
        projects.length > 0 && (
          <section class="animate">
            <div class="flex items-center gap-3 mb-12">
              <h2 class="text-xs font-medium text-black/40 dark:text-white/40 uppercase tracking-widest">
                Featured Projects
              </h2>
              <div class="flex-1 h-px bg-gradient-to-r from-black/10 to-transparent dark:from-white/10" />
            </div>
            <ul class="flex flex-col gap-4">
              {projects.map((project) => (
                <li>
                  <ArrowCard entry={project} />
                </li>
              ))}
            </ul>
            <div class="mt-10">
              <Link href="/projects" class="text-sm font-medium group">
                <span class="inline-flex items-center gap-1">
                  View all projects
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 stroke-2 fill-none stroke-current translate-x-0 group-hover:translate-x-1 transition-transform duration-200"
                  >
                    <line x1="5" y1="12" x2="19" y2="12" />
                    <polyline points="12 5 19 12 12 19" />
                  </svg>
                </span>
              </Link>
            </div>
          </section>
        )
      }

      <!-- Blog -->
      {
        blog.length > 0 && (
          <section class="animate">
            <div class="flex items-center gap-3 mb-12">
              <h2 class="text-xs font-medium text-black/40 dark:text-white/40 uppercase tracking-widest">
                Writing
              </h2>
              <div class="flex-1 h-px bg-gradient-to-r from-black/10 to-transparent dark:from-white/10" />
            </div>
            <ul class="flex flex-col gap-4">
              {blog.map((post) => (
                <li>
                  <ArrowCard entry={post} />
                </li>
              ))}
            </ul>
            <div class="mt-10">
              <Link href="/blog" class="text-sm font-medium group">
                <span class="inline-flex items-center gap-1">
                  View all posts
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    class="w-3 h-3 stroke-2 fill-none stroke-current translate-x-0 group-hover:translate-x-1 transition-transform duration-200"
                  >
                    <line x1="5" y1="12" x2="19" y2="12" />
                    <polyline points="12 5 19 12 12 19" />
                  </svg>
                </span>
              </Link>
            </div>
          </section>
        )
      }

      <!-- Connect -->
      <section
        class="animate pt-12 border-t border-black/5 dark:border-white/5"
      >
        <div class="flex items-center gap-3 mb-8">
          <h2
            class="text-xs font-medium text-black/40 dark:text-white/40 uppercase tracking-widest"
          >
            Connect
          </h2>
          <div
            class="flex-1 h-px bg-gradient-to-r from-black/10 to-transparent dark:from-white/10"
          >
          </div>
        </div>
        <p class="text-sm text-black/60 dark:text-white/50 mb-8 max-w-xl">
          Let's build something great together.
        </p>
        <ul class="flex flex-wrap gap-x-8 gap-y-3 text-sm">
          {
            SOCIALS.map((SOCIAL) => (
              <li>
                <Link
                  href={SOCIAL.HREF}
                  external
                  aria-label={`${SITE.NAME} on ${SOCIAL.NAME}`}
                  class="font-medium text-black/60 dark:text-white/50 hover:text-black dark:hover:text-white transition-colors duration-200"
                >
                  {SOCIAL.NAME}
                </Link>
              </li>
            ))
          }
          <li>
            <Link
              href={`mailto:${SITE.EMAIL}`}
              aria-label={`Email ${SITE.NAME}`}
              class="font-medium text-black/60 dark:text-white/50 hover:text-black dark:hover:text-white transition-colors duration-200"
            >
              Email
            </Link>
          </li>
        </ul>
      </section>
    </div>
  </Container>
</PageLayout>
